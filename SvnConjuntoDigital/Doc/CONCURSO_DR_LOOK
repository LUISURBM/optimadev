CREATE TABLE IDT_FAMILIY (
  FML_COD VARCHAR(7) NOT NULL ,
  FML_NMB VARCHAR(7) NOT NULL ,
  FML_DCS VARCHAR(100),
  FML_LNG INT(10),
  FML_DCM INT(100),
  FML_TPD VARCHAR(10),
  FML_FCH DATE,
  FML_FMT_COD VARCHAR(7),
  FML_USR INT(10),
  PRIMARY KEY  (FML_COD,FML_NMB)
);

CREATE TABLE IDT_FAMILIES_TYPES (
  FMT_COD VARCHAR(7) NOT NULL ,
  FMT_NMB VARCHAR(7),
  FMT_FCH DATE,
  FMT_DCS VARCHAR(100),
  FMT_USR INT(10),
  PRIMARY KEY  (FMT_COD)
);

CREATE TABLE DL_PRS (
  PRS_IDNF INT(10) NOT NULL AUTO_INCREMENT,
  PRS_NIDF INT(30) NOT NULL,
  PRS_NMB VARCHAR(100),
  PRS_APD VARCHAR(100),
  FMT_TIDF VARCHAR(7),
  PRS_TEL VARCHAR(20),
  PRS_CRR VARCHAR(100),
  PRS_FNC DATE,
  PRS_OBS VARCHAR(100),
  FMT_TPRS VARCHAR(7),
  PRS_RPS_IDNF INT(10),
  PRIMARY KEY  (PRS_IDNF,PRS_NIDF)
);

CREATE TABLE DL_USR (
  USR_IDNF INT(10) NOT NULL AUTO_INCREMENT,
  USR_CNTS VARCHAR(300),
  USR_FRG DATE,
  USR_REG_IDNF INT(10),
  USR_FMD DATE,
  USR_MOD_IDNF INT(10),
  FMT_ROLE VARCHAR(7),
  PRIMARY KEY  (USR_IDNF)
);

CREATE TABLE DL_IMG (
  IMG_IDNF INT(10) NOT NULL AUTO_INCREMENT,
  IMG_NMB VARCHAR(100) NOT NULL,
  IMG_DIR VARCHAR(10),
  USR_PRT_IDNF INT(10),
  FMT_STAT VARCHAR(7),
  PRIMARY KEY  (IMG_IDNF,IMG_NMB)
);

ALTER TABLE IDT_FAMILIY ADD CONSTRAINT IDT_FAMILIY_fk1 FOREIGN KEY (FML_FMT_COD) REFERENCES IDT_FAMILIES_TYPES(FMT_COD);

ALTER TABLE DL_PRS ADD CONSTRAINT DL_PRS_fk1 FOREIGN KEY (FMT_TIDF) REFERENCES IDT_FAMILIES_TYPES(FMT_COD);
ALTER TABLE DL_PRS ADD CONSTRAINT DL_PRS_fk2 FOREIGN KEY (FMT_TPRS) REFERENCES IDT_FAMILIES_TYPES(FMT_COD);
ALTER TABLE DL_PRS ADD CONSTRAINT DL_PRS_fk3 FOREIGN KEY (PRS_RPS_IDNF) REFERENCES DL_PRS(PRS_IDNF);
ALTER TABLE DL_USR ADD CONSTRAINT DL_USR_fk1 FOREIGN KEY (USR_REG_IDNF) REFERENCES DL_USR(USR_IDNF);
ALTER TABLE DL_USR ADD CONSTRAINT DL_USR_fk2 FOREIGN KEY (USR_MOD_IDNF) REFERENCES DL_USR(USR_IDNF);
ALTER TABLE DL_USR ADD CONSTRAINT DL_USR_fk3 FOREIGN KEY (FMT_ROLE) REFERENCES IDT_FAMILIES_TYPES(FMT_COD);
ALTER TABLE DL_IMG ADD CONSTRAINT DL_IMG_fk1 FOREIGN KEY (USR_PRT_IDNF) REFERENCES DL_USR(USR_IDNF);
ALTER TABLE DL_IMG ADD CONSTRAINT DL_IMG_fk2 FOREIGN KEY (FMT_STAT) REFERENCES IDT_FAMILIES_TYPES(FMT_COD);
